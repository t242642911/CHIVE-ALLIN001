<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>éŸ­å¿ƒç®´è¨€ï½œå°æˆ°ç‰ˆ v2</title>
  <meta name="description" content="å°æˆ°ç‰ˆï¼šå…§ç›¤/å³å°‡é–‹ç›¤/å¤–ç›¤ Ã— SOL/BSC Ã— å°æ‰‹ï¼ˆCZ/é¯¨é­š/åº„å®¶/å¤§è€/DEV + è‡ªè¨‚/æ“´å……åå–®ï¼‰ã€‚å« 3â†’2â†’1 å€’æ•¸ã€éš¨æ©Ÿ MEME å¹£åã€ğŸš€å¹£ç‹ä¾†äº†(10s é›™å€)ã€ğŸ¦¢é»‘å¤©éµ(å°æ‰‹é™é€Ÿ10s)ã€æ§“æ¡¿x2/x5/x10(10s)ã€‚å¯ç–ŠåŠ ã€‚" />
  <meta name="theme-color" content="#10b981" />
  <style>
    :root{ --bg:#0b1020; --panel:#0e1425; --txt:#e6f0ff; --muted:#9fb3d5; --ring:0 0 0 6px rgba(34,197,94,.2); }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0; background:
      radial-gradient(1200px 800px at 80% -10%, rgba(251,146,60,.2), transparent 60%),
      radial-gradient(900px 700px at 8% 110%, rgba(34,197,94,.12), transparent 55%),
      var(--bg);
      color:var(--txt); font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", sans-serif; line-height:1.6}
    .container{width:min(1180px,92vw); margin:0 auto}
    header{position:sticky; top:0; backdrop-filter: blur(8px); background:linear-gradient(180deg, rgba(11,16,32,.9), rgba(11,16,32,.55) 70%, transparent); border-bottom:1px solid rgba(255,255,255,.08); padding:18px 0 10px}
    .brand{display:flex; align-items:center; gap:12px}
    .logo{width:36px; height:36px; border-radius:12px; display:grid; place-items:center; background:linear-gradient(145deg,#22c55e,#16a34a); color:#06250f; font-weight:900}
    .tag{font-size:13px; color:var(--muted)}

    .hero{display:grid; grid-template-columns:1.15fr .85fr; gap:20px; align-items:center; padding:20px 0}
    @media (max-width:980px){.hero{grid-template-columns:1fr}}
    .chip{display:inline-flex; gap:8px; align-items:center; background:rgba(34,197,94,.08); color:#86efac; border:1px solid rgba(34,197,94,.35); border-radius:999px; padding:5px 10px; font-size:13px}
    h1,h2,h3,h4{margin:0}
    h2{font-size:clamp(24px,3.2vw + 10px,46px); line-height:1.1}
    .lead{color:var(--muted)}

    .card{background:linear-gradient(180deg,#0f172a,#0b1226); border:1px solid rgba(255,255,255,.08); border-radius:18px; padding:16px; box-shadow:0 20px 60px rgba(0,0,0,.35)}
    .panel-title{display:flex; justify-content:space-between; align-items:center; gap:12px}

    /* å°æˆ°å ´æ™¯ */
    .arena{display:grid; grid-template-columns:1fr 1fr; gap:14px}
    @media (max-width:980px){.arena{grid-template-columns:1fr}}
    .playground{position:relative; height:460px; border-radius:16px; overflow:hidden; background:linear-gradient(180deg,#0f1630,#0b1226)}
    .lane-title{position:absolute; left:12px; top:10px; font-weight:800; background:rgba(7,12,24,.55); border:1px solid rgba(255,255,255,.08); padding:6px 10px; border-radius:10px; z-index:3}
    .hud{display:flex; gap:14px; align-items:center; flex-wrap:wrap}
    .score{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New"; background:#0b1730; border:1px solid rgba(255,255,255,.08); padding:3px 8px; border-radius:8px}
    .ctrls{display:flex; gap:10px; flex-wrap:wrap}
    button{appearance:none; border:1px solid rgba(255,255,255,.14); background:#14203a; color:var(--txt); padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:700}
    button.primary{background:linear-gradient(145deg,#22c55e,#16a34a); color:#06250f; border:none}
    button:focus-visible{outline:none; box-shadow:var(--ring)}

    /* è¡¨å–® */
    form{display:grid; grid-template-columns:1.1fr .9fr .9fr .9fr auto; gap:10px; align-items:end}
    @media (max-width:1100px){form{grid-template-columns:1fr 1fr 1fr;}}
    @media (max-width:720px){form{grid-template-columns:1fr 1fr;}}
    label{font-size:13px; color:var(--muted)}
    input,select{width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.14); background:#0f1730; color:var(--txt)}

    /* å°éŸ­èœ / éšœç¤™ç‰© */
    .chive,.hazard{position:absolute; width:64px; height:64px; transform: translate(-50%,-50%) scale(.92); display:grid; place-items:center; cursor:pointer; filter:drop-shadow(0 6px 12px rgba(0,0,0,.35)); animation:pop .22s ease-out}
    .chive:hover,.hazard:hover{transform: translate(-50%,-50%) scale(1.02)}
    @keyframes pop{from{opacity:0; transform: translate(-50%,-48%) scale(.6)} to{opacity:1; transform:translate(-50%,-50%) scale(.92)}}
    .vanish{animation: vanish .26s ease-in forwards}
    @keyframes vanish{to{opacity:0; transform:translate(-50%,-42%) scale(.4)}}
    .leaf{fill:#86efac} .leaf2{fill:#34d399} .band{fill:#fde68a} .face{fill:#14532d}
    .hazard-shape{fill:#ef4444; stroke:#991b1b; stroke-width:2}

    /* è‰åœ°èˆ‡å°éŸ­èœèƒŒæ™¯ */
    .playground::before{content:""; position:absolute; inset:0; z-index:0; opacity:.9; background:
      radial-gradient(1200px 800px at 80% -10%, rgba(251,146,60,.18), transparent 60%),
      radial-gradient(900px 700px at 8% 110%, rgba(134,239,172,.16), transparent 55%),
      url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><rect width="160" height="160" fill="%2310291f"/><g opacity="0.9"><circle cx="20" cy="140" r="2" fill="%2339ff88"/><circle cx="80" cy="120" r="2" fill="%2339ff88"/><circle cx="140" cy="130" r="2" fill="%2339ff88"/><path d="M18 138 C18 128,22 118,30 110 C28 125,28 132,30 138 Z" fill="%235eead4"/><path d="M78 118 C78 108,82 98,90 90 C88 105,88 112,90 118 Z" fill="%2322c55e"/><path d="M138 128 C138 118,142 108,150 100 C148 115,148 122,150 128 Z" fill="%2322c55e"/></g></svg>');
      background-size: auto, auto, 220px 220px; background-repeat: no-repeat, no-repeat, repeat; background-position: center, center, 0 0;}
    .playground > *{position:relative; z-index:1}

    /* é£„å­— */
    .float{position:absolute; pointer-events:none; font-weight:900; color:#39ff88; text-shadow:0 2px 8px rgba(0,0,0,.45); animation:floatUp .8s ease-out forwards}
    .float.neg{color:#f87171}
    @keyframes floatUp{from{opacity:0; transform:translate(-50%,-40%) scale(.9)} 30%{opacity:1} to{opacity:0; transform:translate(-50%,-120%) scale(1)}}

    /* äº‹ä»¶å¾½ç«  */
    .event{position:absolute; left:50%; top:14%; transform:translate(-50%,-50%); z-index:4; background:rgba(14,22,46,.85); border:1px solid rgba(255,255,255,.16); padding:8px 12px; border-radius:12px; font-weight:800; cursor:pointer; box-shadow:0 6px 18px rgba(0,0,0,.35)}
    .event:hover{background:rgba(14,22,46,.95)}

    /* å€’æ•¸é®ç½© */
    .countdown{position:absolute; inset:0; display:grid; place-items:center; background:rgba(6,10,20,.65); z-index:6; font-weight:900; font-size:92px; letter-spacing:1px}

    /* çµç®—èˆ‡ç´€éŒ„ */
    .modal{position:fixed; inset:0; display:none; place-items:center; background:rgba(8,12,24,.6); backdrop-filter: blur(6px); z-index:9999}
    .box{background:linear-gradient(180deg,#0f172a,#0b1226); border:1px solid rgba(255,255,255,.1); border-radius:16px; padding:18px; width:min(860px,92%); text-align:center}
    table{width:100%; border-collapse:collapse; font-size:14px}
    th,td{border-bottom:1px solid rgba(255,255,255,.08); padding:8px 6px; text-align:center}
    .kicker{color:#fecaca}
  </style>
</head>
<body>
  <header>
    <div class="container brand">
      <div class="logo">ğŸŒ±</div>
      <div>
        <h1>éŸ­å¿ƒç®´è¨€ï½œå°æˆ°ç‰ˆ v2</h1>
        <div class="tag">ç²¾ç¥ç„¡é™ï¼Œæœ¬é‡‘æœ‰é™ã€‚å¹£åœˆçš„ä¿¡ä»°ï¼Œæœ‰æ™‚åªå€¼ 10Uã€‚</div>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <div>
        <span class="chip">ğŸ¯ ä½œå“å®šä½</span>
        <h2>å¹£åœˆè«·åˆºï¼æƒ…ç·’é‡‘èï¼Meme æ•˜äº‹åœ–åƒ</h2>
        <p class="lead">1 åˆ†é˜å¿«ç¯€å¥ï¼šé»éŸ­èœ +10Uã€ç´…è‰²å¹²æ“¾ç‰© -10Uã€‚æ”¯æ´éˆï¼šSOL / BSCï¼ˆåŒåˆ»å¤§é‡ç”Ÿæˆï¼‰ã€‚</p>
      </div>
      <div class="card">
        <div class="panel-title"><h3>å°æˆ°è¨­å®š</h3></div>
        <form id="cfg">
          <div>
            <label for="playerName">éŸ­èœåç¨±</label>
            <input id="playerName" placeholder="è¼¸å…¥ä½ çš„éŸ­èœåï¼Œä¾‹å¦‚ï¼šå°ç¶ " maxlength="12" />
          </div>
          <div>
            <label for="difficulty">é›£åº¦ï¼ˆç¯€å¥ï¼‰</label>
            <select id="difficulty">
              <option value="inner">å…§ç›¤ï¼ˆæœ€å¿«ï¼‰</option>
              <option value="premarket">å³å°‡é–‹ç›¤ï¼ˆä¸­ç­‰ï¼‰</option>
              <option value="outer">å¤–ç›¤ï¼ˆæœ€æ…¢ï¼‰</option>
            </select>
          </div>
          <div>
            <label for="chain">éˆ</label>
            <select id="chain">
              <option value="SOL" selected>SOL</option>
              <option value="BSC">BSCï¼ˆåŒåˆ»å¤§é‡ç”Ÿæˆï¼‰</option>
            </select>
          </div>
          <div>
            <label>å°æ‰‹</label>
            <div style="display:flex; gap:8px; align-items:end">
              <button type="button" id="chooseOppBtn">ğŸ“‹ é¸æ“‡å°æ‰‹</button>
              <input id="opponent" type="text" value="è¶™é•·éµ¬CZ" style="display:none"/>
              <span class="score" id="chosenOpp">è¶™é•·éµ¬CZ</span>
              <button type="button" id="addOppBtn">â•å°æ‰‹è³‡æ–™</button>
            </div>
          </div>
          <button type="button" class="primary" id="startAll">â–¶ é–‹å§‹å°æˆ°</button>
        </form>
        <div id="oppInfo" class="card" style="margin-top:12px; padding:12px; background:rgba(15,23,42,.5); border:1px solid rgba(255,255,255,.08)">
          <div style="font-weight:700; margin-bottom:6px">å°æ‰‹ç°¡ä»‹</div>
          <div id="oppInfoBody" class="tag">è«‹å…ˆåœ¨ä¸Šæ–¹é¸æ“‡å°æ‰‹ï¼Œé€™è£¡æœƒé¡¯ç¤ºä»–çš„è³‡ç”¢ã€é›£åº¦èˆ‡ä¸€å¥è©±ä»‹ç´¹ã€‚</div>
        </div>
      </div>
    </section>

    <section class="card">
      <div class="panel-title">
        <h3>å°æˆ°å ´æ™¯ï¼ˆé™æ™‚ 1 åˆ†é˜ï¼Œä¸æ–·åŠ é€Ÿï¼‰</h3>
        <div class="hud">â± å‰©é¤˜ <span id="rest">60.0s</span>ï½œğŸª™ å¹£ï¼š<span class="score" id="coinTag">$CHIVE</span>ï½œğŸ£ ç©å®¶ <span class="score" id="pScore">0</span> Uï½œAPM <span class="score" id="pApm">0</span>ï½œğŸ¤– å°æ‰‹ <span class="score" id="bScore">0</span> Uï½œAPM <span class="score" id="bApm">0</span></div>
      </div>
      <div class="arena" id="arena">
        <div class="playground" id="pLane">
          <div class="lane-title">ç©å®¶ï¼š<b id="pName">æœªå‘½å</b></div>
        </div>
        <div class="playground" id="bLane">
          <div class="lane-title"><b id="bName">CZ ğŸŸ¢</b></div>
        </div>
      </div>
      <div class="ctrls" style="margin-top:10px">
        <button id="stopBtn">â–  åœæ­¢</button>
        <button id="muteBtn">ğŸ”Š è²éŸ³é–‹</button>
        <button id="surrenderBtn">ğŸ³ æŠ•é™</button>
        <span class="tag">æç¤ºï¼šé»åˆ°éŸ­èœã€Œ+10Uã€ï¼Œé»åˆ°å¥‡æ€ªç‰©ã€Œ-10Uã€ã€‚è¶Šæ¥è¿‘ 0 ç§’è¶Šå¿«ã€‚BSC éˆæœƒåŒåˆ»å¤§é‡ç”Ÿæˆã€‚äº‹ä»¶å¯ç–ŠåŠ ã€‚</span>
      </div>
    </section>
  </main>

  <!-- å°æ‰‹é¸æ“‡å™¨ï¼ˆé¡¯ç¤ºå…¨éƒ¨å°æ‰‹çš„æ¡†ï¼‰ -->
  <div class="modal" id="oppModal" style="display:none;">
    <div class="box">
      <h3>é¸æ“‡å°æ‰‹</h3>
      <div class="ctrls seg" style="justify-content:center; margin-bottom:10px">
        <button class="primary" data-tier="ALL">ğŸ“š å…¨éƒ¨</button>
        <button data-tier="GOD">ğŸŸ£ GOD</button>
        <button data-tier="UR">ğŸ”¥ UR</button>
        <button data-tier="SSR">â­ SSR</button>
        <button data-tier="SR">ğŸŸ¡ SR</button>
        <button data-tier="R">ğŸŸ  R</button>
        <button data-tier="N">âšª N</button>
        <button id="oppClose">é—œé–‰</button>
      </div>
      <div id="oppGrid" style="display:grid; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:10px; text-align:left; max-height:420px; overflow:auto; padding-right:6px"></div>
      <hr style="border-color:rgba(255,255,255,.08)">
      <h4 style="margin:6px 0 8px">è‡ªè¨‚å°æ‰‹</h4>
      <div class="ctrls" style="flex-wrap:wrap">
        <input id="customOppName" placeholder="è¼¸å…¥åç¨±ï¼Œå¦‚ï¼šæŸKOL" style="flex:2; min-width:200px">
        <select id="customOppTier" style="flex:1; min-width:140px">
          <option value="N">âšª Nï¼ˆæœ€æ…¢ï¼‰</option>
          <option value="R">ğŸŸ  R</option>
          <option value="SR">ğŸŸ¡ SR</option>
          <option value="SSR">â­ SSR</option>
          <option value="UR">ğŸ”¥ UR</option>
          <option value="GOD">ğŸŸ£ GODï¼ˆæœ€å¿«ï¼‰</option>
        </select>
        <button id="customOppAdd" class="primary">åŠ å…¥åå–®</button>
      </div>
    </div>
  </div>

  <div class="modal" id="modal"><div class="box">
    <h3>æ™‚é–“åˆ°ï¼</h3>
    <p>ç©å®¶ <b id="mP">0</b> Uï¼ˆAPM <b id="mPA">0</b>ï¼‰ï½œå°æ‰‹ <b id="mB">0</b> Uï¼ˆAPM <b id="mBA">0</b>ï¼‰</p>
    <p id="mR">â€”</p>
    <div class="ctrls" style="justify-content:center">
      <button class="primary" id="restart">å†ä¾†ä¸€å±€</button>
      <button id="close">è¿”å›è¨­å®š</button>
    </div>
  </div></div>

  <script>
  // ========= éŸ³æ•ˆ =========
  const SFX = (function(){
    const ctx = new (window.AudioContext||window.webkitAudioContext)();
    let muted=false;
    const env=(dur=.15,gain=.35)=>{const g=ctx.createGain();g.gain.value=.0001;g.gain.exponentialRampToValueAtTime(gain,ctx.currentTime+.01);g.gain.exponentialRampToValueAtTime(.0001,ctx.currentTime+dur);g.connect(ctx.destination);return g};
    const tone=(type,freq,dur=.12)=>{if(muted) return; const o=ctx.createOscillator();o.type=type;o.frequency.value=freq;const g=env(dur);o.connect(g);o.start();o.stop(ctx.currentTime+dur)};
    const coin=()=>{if(muted) return; const now=ctx.currentTime;const o=ctx.createOscillator();o.type='square';o.frequency.value=880;const g=env(.18,.3);o.connect(g);o.frequency.exponentialRampToValueAtTime(1320,now+.16);o.start();o.stop(now+.18)};
    const buzz=()=>{if(muted) return; const o=ctx.createOscillator(); const g=env(.16,.28); o.type='sawtooth'; o.frequency.setValueAtTime(240, ctx.currentTime); o.frequency.exponentialRampToValueAtTime(110, ctx.currentTime+.14); o.connect(g); o.start(); o.stop(ctx.currentTime+.16)};
    const pop=()=>tone('triangle',420,.09);
    const click=()=>tone('sine',280,.06);
    const toggle=()=>{muted=!muted;return !muted};
    const resume=()=>{if(ctx.state==='suspended') ctx.resume()};
    return {coin,buzz,pop,click,toggle,resume};
  })();

  // ========= å…ƒä»¶æŸ¥æ‰¾ =========
  const $=s=>document.querySelector(s);
  const pLane=$('#pLane'), bLane=$('#bLane');
  const restEl=$('#rest'), pScoreEl=$('#pScore'), bScoreEl=$('#bScore');
  const pApmEl=$('#pApm'), bApmEl=$('#bApm');
  const pNameEl=$('#pName'), bNameEl=$('#bName');
  const coinTag=$('#coinTag');
  const startBtn=$('#startAll'), stopBtn=$('#stopBtn'), muteBtn=$('#muteBtn');
  const modal=$('#modal'), mP=$('#mP'), mB=$('#mB'), mR=$('#mR'), mPA=$('#mPA'), mBA=$('#mBA');
  const restart=$('#restart'), closeBtn=$('#close');
  const logTBody=document.querySelector('#log tbody');
  const tip=$('#tip');

  // ========= ç‹€æ…‹ =========
  let round=0, history=[];
  let running=false, startAt=0, endAt=0;
  let pScore=0, bScore=0; let pClicks=0, bClicks=0;
  let spawnTimerP=null, spawnTimerB=null, tickTimer=null;
  let timers=[]; // äº‹ä»¶èˆ‡å€’æ•¸è¨ˆæ™‚å™¨

  // äº‹ä»¶ç‹€æ…‹
  let doubleUntil=0; // å¹£ç‹ä¾†äº†ï¼šç©å®¶å¾—åˆ† x2
  let swanUntil=0;   // é»‘å¤©éµï¼šå°æ‰‹å»¶é² x2ï¼ˆè®Šæ…¢ï¼‰
  let levUntil=0;    // æ§“æ¡¿æœ‰æ•ˆæœŸ
  let levMul=1;      // 1 / 2 / 5 / 10ï¼ˆåƒ…ç©å®¶ï¼‰
  let levSpawned=false; // æ¯å±€åƒ…ä¸€æ¬¡

  // é€²å ´å€’æ•¸é®ç½©
  function showCountdown(cb){
    const cover=document.createElement('div'); cover.className='countdown'; cover.textContent='3';
    $('#arena').appendChild(cover);
    let t=3; const step=()=>{ t--; if(t>0){ cover.textContent=String(t); timers.push(setTimeout(step,740)); }else{ cover.textContent='GO!'; timers.push(setTimeout(()=>{ cover.remove(); cb&&cb(); }, 520)); } };
    timers.push(setTimeout(step,740));
  }

  const OPP_SYMBOL={ 'CZ':'ğŸŸ¢', 'é¯¨é­š':'ğŸ‹', 'åº„å®¶':'ğŸ­', 'å¤§è€':'ğŸ¦', 'DEV':'ğŸ§ ' };

  const DIFFS={
    inner:{ pSpawn:[800,100], pLife:[4200,1200], bDelay:[60,18] },
    premarket:{ pSpawn:[1000,180], pLife:[4800,1500], bDelay:[90,36] },
    outer:{ pSpawn:[1200,220], pLife:[5200,1700], bDelay:[120,54] }
  };

  // èˆŠäº”åä¿ç•™ï¼Œæ»¿è¶³æ¸¬è©¦æ–·è¨€
  const BOT_PROFILE={ 'CZ':{clickBias:.65}, 'é¯¨é­š':{clickBias:.70}, 'åº„å®¶':{clickBias:.78}, 'å¤§è€':{clickBias:.88}, 'DEV':{clickBias:.95} };

  // åˆ†ç´šå€ç‡ï¼ˆè¶Šé«˜è¶Šå¿«ï¼‰
  const TIER_BIAS={ GOD:.99, UR:.95, SSR:.88, SR:.78, R:.70, N:.60 };
  const TIER_SYMBOL={ GOD:'ğŸŸ£', UR:'ğŸ”¥', SSR:'â­', SR:'ğŸŸ¡', R:'ğŸŸ ', N:'âšª' };

  // å°æ‰‹åå–®ï¼ˆå¯æ“´å……ï¼‰
  const ROSTER=[
    {name:'ä¸­æœ¬è°', tier:'GOD'},
    {name:'è¶™é•·éµ¬CZ', tier:'UR'},{name:'å­«å®‡æ™¨', tier:'UR'},{name:'è–›è »å­', tier:'UR'},{name:'å³å¿Œå¯’', tier:'UR'},{name:'å¾æ˜æ˜Ÿ', tier:'UR'},{name:'æœå‡', tier:'UR'},{name:'ä½•ä¸€', tier:'UR'},{name:'ææ—', tier:'UR'},{name:'Vç¥', tier:'UR'},{name:'Roger Ver', tier:'UR'},{name:'Yi He', tier:'UR'},{name:'HongKongDoll', tier:'UR'},
    {name:'æå•“å¨', tier:'SSR'},{name:'BM', tier:'SSR'},{name:'æ²ˆæ³¢', tier:'SSR'},{name:'è¶™æ±', tier:'SSR'},{name:'å‘¨ç¢©åŸº', tier:'SSR'},{name:'æç¬‘ä¾†', tier:'SSR'},{name:'é”é´»é£›', tier:'SSR'},{name:'ä½•æ–Œ', tier:'SSR'},{name:'é•·é‹', tier:'SSR'},{name:'å¸¥åˆ', tier:'SSR'},{name:'éŸ“å³¯', tier:'SSR'},{name:'æ±Ÿå“çˆ¾', tier:'SSR'},{name:'å‘‚æ—­è»', tier:'SSR'},{name:'ç‹å¯¶è²¡', tier:'SSR'},{name:'å¯¶äºŒçˆº', tier:'SSR'},{name:'Dujun(KOL)', tier:'SSR'},{name:'WolfyXBT', tier:'SSR'},{name:'Star(OKX)', tier:'SSR'},{name:'Phyrex', tier:'SSR'},{name:'0xWizard', tier:'SSR'},{name:'ä½™å¼¦', tier:'SSR'},{name:'èŠ±èŠ±', tier:'SSR'},{name:'å¤§å®‡', tier:'SSR'},{name:'ç†¬é·¹è³‡æœ¬', tier:'SSR'},{name:'å·æ²', tier:'SSR'},{name:'Aiå§¨', tier:'SSR'},{name:'Gokuå¾ˆCool', tier:'SSR'},{name:'Jason', tier:'SSR'},{name:'Moonlight', tier:'SSR'},{name:'ä½™çƒ¬', tier:'SSR'},{name:'Ninerä¹å…’', tier:'SSR'},{name:'ç«æ˜Ÿäºº', tier:'SSR'},{name:'è¶™åœ‹å³¯', tier:'SSR'},{name:'ç”³å± é’æ˜¥', tier:'SSR'},{name:'æ½˜åœ‹åŠ›', tier:'SSR'},{name:'é»ƒé€£é‡‘', tier:'SSR'},{name:'åˆå¤è™', tier:'SSR'},{name:'æœ±å˜‰å‰', tier:'SSR'},{name:'è«‡åœ‹éµ¬', tier:'SSR'},{name:'å·¨èŸ¹', tier:'SSR'},{name:'é«˜åŸé£›ç‡•', tier:'SSR'},{name:'è—ç·£å¯¶YYBCåˆå¤¥äºº â€”', tier:'SSR'},
    {name:'Benmo.eth', tier:'SR'},{name:'AB Kuai', tier:'SR'},{name:'å­æ™‚', tier:'SR'},{name:'æ½›æ°´è§€å¯Ÿå“¡', tier:'SR'},{name:'å†·éœå†·éœ', tier:'SR'},{name:'Rui', tier:'SR'},{name:'Sea', tier:'SR'},{name:'Bruce', tier:'SR'},{name:'Rocky', tier:'SR'},
    {name:'Ru7', tier:'R'},{name:'Cindyèƒ–è¿ª', tier:'R'},{name:'KingPan', tier:'R'},
    {name:'XinGPT', tier:'N'},{name:'BlueFox', tier:'N'},{name:'Dotç‹å­', tier:'N'},{name:'MoonApe', tier:'N'},{name:'CryptoMaid', tier:'N'},{name:'JamesX', tier:'N'},{name:'å°åˆ€', tier:'N'},{name:'ZeroValue', tier:'N'}
  ];

  const OppMap=new Map(); ROSTER.forEach(o=>OppMap.set(o.name,o.tier));
  function tierOf(name){ return OppMap.get(name) || (name in BOT_PROFILE ? (name==='DEV'?'UR':'SR') : 'N'); }
  function getBotBias(name){ const t=tierOf(name); return TIER_BIAS[t] || .65; }

  function renderOppGrid(filterTier){
    const wrap=document.getElementById('oppGrid');
    wrap.innerHTML='';
    const list = (!filterTier || filterTier==='ALL')? ROSTER : ROSTER.filter(o=>o.tier===filterTier);
    list.forEach(o=>{
      const btn=document.createElement('button');
      btn.innerHTML=`${TIER_SYMBOL[o.tier]||''} ${o.name}`;
      btn.addEventListener('click',()=>{
        document.getElementById('opponent').value=o.name;
        document.getElementById('chosenOpp').textContent=o.name;
        document.getElementById('bName').textContent=o.name + ' ' + (TIER_SYMBOL[o.tier]||'');
        updateOppInfo(o.name);
        document.getElementById('oppModal').style.display='none';
      });
      wrap.appendChild(btn);
    });
  }

  const tierButtons = [];
  function setActiveTier(btn){ tierButtons.forEach(x=>x.classList.remove('primary')); btn.classList.add('primary'); }
  function openOppModal(){
    const m=document.getElementById('oppModal');
    m.style.display='grid';
    renderOppGrid('ALL');
    const first=document.querySelector('#oppModal [data-tier="ALL"]')||document.querySelector('#oppModal [data-tier]');
    setActiveTier(first);
  }

  const NETS={
    SOL: { burst:[1,1], hazardBias: 0.00 },
    BSC: { burst:[2,5], hazardBias: 0.05 }
  };

  const current={ name:'æœªå‘½å', diff:'inner', opp:'è¶™é•·éµ¬CZ', net:'SOL', coin:'$CHIVE' };

  const MOVE_CHANCE = 0.45; // éƒ¨åˆ†éŸ­èœæœƒç§»å‹•ï¼ˆæ‰“åœ°é¼ æ„Ÿï¼‰

  function lerp(a,b,t){return a+(b-a)*t}
  function now(){return Date.now()}
  function labelOf(d){ return d==='inner'?'å…§ç›¤': d==='premarket'?'å³å°‡é–‹ç›¤':'å¤–ç›¤'; }
  function resetScores(){ pScore=0; bScore=0; pClicks=0; bClicks=0; pScoreEl.textContent=pScore; bScoreEl.textContent=bScore; pApmEl.textContent='0'; bApmEl.textContent='0'; }

  // ========= å¹£åç”Ÿæˆ =========
  const COIN_BANK=['PEPE','DOGE','SHIB','BONK','WIF','FLOKI','CAT','PONKE','HAMA','MOG','GME','ROAR','FOMO','APU','BABY','MOON','LUNA','RUG'];
  function genCoin(){
    const pre=['MOON','SUPER','HYPER','BABY','LIL','SPACE','META','PEPE','DOGE','BONK','CAT','PONKE','MOG','WIF'];
    const suf=['X','AI','INU','KING','LORD','BOT','PEPE','DOGE','CAT','COIN','FUND','BULL','ROCKET'];
    if(Math.random()<0.5){ return '$'+COIN_BANK[Math.floor(Math.random()*COIN_BANK.length)]; }
    return '$'+ pre[Math.floor(Math.random()*pre.length)] + suf[Math.floor(Math.random()*suf.length)];
  }

  // ========= SVG =========
  const chiveSVG=()=>`<svg viewBox="0 0 64 64" aria-hidden="true">
    <g>
      <path class="leaf" d="M20 50 C18 34, 22 20, 30 8 C28 24, 28 38, 30 50 Z"/>
      <path class="leaf2" d="M44 50 C46 34, 42 20, 34 8 C36 24, 36 38, 34 50 Z"/>
      <rect x="24" y="46" width="16" height="8" rx="4" class="band"/>
      <circle cx="28" cy="36" r="2" class="face"/>
      <circle cx="36" cy="36" r="2" class="face"/>
      <path d="M28 42 Q32 45 36 42" class="face" fill="none" stroke-width="2" stroke-linecap="round" stroke="currentColor"/>
    </g>
  </svg>`;

  const hazardSVG=()=>`<svg viewBox="0 0 64 64" aria-hidden="true">
    <g class="hazard-shape">
      <circle cx="32" cy="32" r="18" fill="#7f1d1d"/>
      <path d="M22 28 L42 28 L38 40 L26 40 Z"/>
      <circle cx="27" cy="26" r="3" fill="#ef4444"/>
      <circle cx="37" cy="26" r="3" fill="#ef4444"/>
      <path d="M24 46 Q32 50 40 46" stroke="#991b1b" fill="none" stroke-width="3" stroke-linecap="round"/>
    </g>
  </svg>`;

  // ========= å°å·¥å…· =========
  function spawnFloat(lane, x, y, text, neg){ const f=document.createElement('div'); f.className='float'+(neg?' neg':''); f.textContent=text; f.style.left=x+'px'; f.style.top=y+'px'; lane.appendChild(f); timers.push(setTimeout(()=>f.remove(), 900)); }
  function apm(clicks, elapsedMs){ const m=Math.max(0.016, elapsedMs/60000); return Math.round((clicks/m)); }
  function hazardRate(progress){ const base=0.15 + 0.10*progress; const bias=(NETS[current.net]?.hazardBias||0); return Math.min(0.5, base + bias); }
  function burstCount(progress){ const cfg=NETS[current.net]||NETS.SOL; const c=Math.round( lerp(cfg.burst[0], cfg.burst[1], progress) ); return Math.max(1,c); }
  function getMul(){ const t=now(); let m=1; if(t<doubleUntil) m*=2; if(t<levUntil) m*=levMul; return m; }
  function addScore(side, delta){
    if(side==='p'){
      const mul = getMul();
      if(delta>0) pScore += delta * mul;
      else pScore += delta * Math.max(1, (now()<levUntil?levMul:1));
      pScoreEl.textContent = pScore;
      pClicks++;
    } else {
      bScore += delta; bScoreEl.textContent = bScore; bClicks++;
    }
  }

  // ========= ç§»å‹•é‚è¼¯ï¼ˆæ‰“åœ°é¼ æ„Ÿï¼‰ =========
  function startDrift(el, lane){
    let alive=true; el.dataset.alive='1';
    const r=()=>lane.getBoundingClientRect();
    let dx=(Math.random()*2+0.6)*(Math.random()<.5?-1:1); // px/frame
    let dy=(Math.random()*2+0.6)*(Math.random()<.5?-1:1);
    const step=()=>{
      if(!alive || !el.isConnected) return;
      const rect=r();
      let x=parseFloat(el.style.left), y=parseFloat(el.style.top);
      x+=dx; y+=dy;
      // é‚Šç•Œåå½ˆ
      if(x<32){x=32; dx*=-1} if(x>rect.width-32){x=rect.width-32; dx*=-1}
      if(y<48){y=48; dy*=-1} if(y>rect.height-36){y=rect.height-36; dy*=-1}
      el.style.left=x+'px'; el.style.top=y+'px';
      requestAnimationFrame(step);
    };
    requestAnimationFrame(step);
    return ()=>{ alive=false; el.dataset.alive='0'; };
  }

  // ========= ç”Ÿæˆ/é»æ“Š =========
  function spawnOne(lane,isBot,progress){
    const isHazard = Math.random() < hazardRate(progress);
    const el=document.createElement('div'); el.className=isHazard?'hazard':'chive'; el.innerHTML=isHazard?hazardSVG():chiveSVG();
    const r=lane.getBoundingClientRect();
    const x=Math.random()*(r.width-80)+40; const y=Math.random()*(r.height-100)+70; el.style.left=x+'px'; el.style.top=y+'px';
    lane.appendChild(el); SFX.pop();

    const conf=DIFFS[current.diff];
    // æ¶ˆå¤±é€Ÿåº¦ï¼šè¶Šå¾Œé¢è¶Šå¿«ï¼ˆlife è¶ŠçŸ­ï¼‰
    const life= lerp(conf.pLife[0], conf.pLife[1], progress) + Math.random()*260;

    // éƒ¨åˆ†éŸ­èœæœƒç§»å‹•ï¼ˆæ‰“åœ°é¼ ï¼‰ï¼Œéšœç¤™ç‰©ä¸ç§»å‹•
    let stopDrift=null; if(!isHazard && Math.random()<MOVE_CHANCE){ stopDrift = startDrift(el, lane); }

    if(!isBot){
      const timer=setTimeout(()=>{ if(stopDrift) stopDrift(); el.classList.add('vanish'); timers.push(setTimeout(()=>el.remove(),240));}, life);
      el.addEventListener('click',(e)=>{
        clearTimeout(timer); if(stopDrift) stopDrift();
        const lr = lane.getBoundingClientRect(); const fx = (e.clientX || (lr.left + parseFloat(el.style.left))); const fy = (e.clientY || (lr.top + parseFloat(el.style.top)));
        const tNow=now();
        const levOnly = (tNow<levUntil)?levMul:1; // å¹£ç‹ä¸å½±éŸ¿è² åˆ†ï¼Œè² åˆ†åªåƒæ§“æ¡¿
        if(isHazard){
          addScore('p', -10);
          SFX.buzz();
          spawnFloat(lane, fx-lr.left, fy-lr.top, '-' + (10*levOnly) + 'U', true);
        } else {
          const mul=getMul();
          addScore('p', +10);
          SFX.coin();
          spawnFloat(lane, fx-lr.left, fy-lr.top, '+' + (10*mul) + 'U', false);
        }
        el.classList.add('vanish'); timers.push(setTimeout(()=>el.remove(),220));
      }, {once:true});
    }else{
      const prof=BOT_PROFILE[current.opp]||BOT_PROFILE['CZ'];
      const baseDelay= lerp(conf.bDelay[0], conf.bDelay[1], progress);
      const bias = (current.opp in BOT_PROFILE)? (BOT_PROFILE[current.opp].clickBias) : getBotBias(current.opp); // è¶Šæ¥è¿‘ 1 è¶Šå¿«
      const slow = (now()<swanUntil)? 2 : 1; // é»‘å¤©éµï¼šå°æ‰‹è®Šæ…¢
      const delay = Math.max(10, (baseDelay * slow) * (1.0 - 0.35*(bias)) + Math.random()*baseDelay*0.25);
      const botTimer=setTimeout(()=>{
        const fx=parseFloat(el.style.left); const fy=parseFloat(el.style.top);
        if(isHazard){ addScore('b', -10); SFX.buzz(); spawnFloat(lane, fx, fy-8, '-10U', true); }
        else         { addScore('b', +10); SFX.coin(); spawnFloat(lane, fx, fy-8, '+10U', false); }
        if(stopDrift) stopDrift();
        el.classList.add('vanish'); timers.push(setTimeout(()=>el.remove(),220));
      }, delay);
      el.addEventListener('click',()=>{ clearTimeout(botTimer); if(stopDrift) stopDrift(); },{once:true});
      timers.push(setTimeout(()=>{try{ if(stopDrift) stopDrift(); el.remove()}catch(e){}}, Math.max(life, 1600)));
    }
  }

  function loopSpawn(){
    if(!running) return;
    const t=now(); const progress = Math.min(1,(t-startAt)/60000);
    const conf=DIFFS[current.diff];
    // ç”Ÿæˆé€Ÿåº¦ï¼šè¶Šå¾Œé¢è¶Šå¿«ï¼ˆé–“éš”è¶ŠçŸ­ï¼‰
    const nextP= lerp(conf.pSpawn[0], conf.pSpawn[1], progress) + Math.random()*160; // ç©å®¶ç”Ÿæˆé–“éš”

    // ç©å®¶å ´ï¼šä¾éˆæ±ºå®š burst
    const bp = burstCount(progress);
    for(let i=0;i<bp;i++){ spawnOne(pLane,false,progress); }
    spawnTimerP=setTimeout(loopSpawn, nextP);

    // å°æ‰‹å ´ï¼šç•¥å¿« + åŒæ­¥ burst
    const nextB= Math.max(50, nextP*0.8);
    const bb = burstCount(progress);
    for(let i=0;i<bb;i++){ spawnOne(bLane,true,progress); }
    spawnTimerB=setTimeout(()=>{ if(running){ const pg=Math.min(1,(now()-startAt)/60000); for(let i=0;i<burstCount(pg);i++){ spawnOne(bLane,true, pg); } } }, nextB);
  }

  function tick(){
    if(!running) return;
    const t=now(); const remain=Math.max(0, endAt-t); restEl.textContent=(remain/1000).toFixed(1)+'s';
    const elapsed=t-startAt; pApmEl.textContent=apm(pClicks,elapsed); bApmEl.textContent=apm(bClicks,elapsed);
    if(remain<=0){ endRound(); return; }
    tickTimer=setTimeout(tick, 120);
  }

  // ========= äº‹ä»¶ï¼šğŸš€ å¹£ç‹ / ğŸ¦¢ é»‘å¤©éµ / æ§“æ¡¿ =========
  function spawnEventBadge(lane, text, onclick, life=3000){
    const b=document.createElement('button'); b.className='event'; b.textContent=text; lane.appendChild(b);
    const kill=()=>{ b.classList.add('vanish'); timers.push(setTimeout(()=>b.remove(), 220)); };
    const tid=setTimeout(kill, life); timers.push(tid);
    b.addEventListener('click', ()=>{ clearTimeout(tid); onclick&&onclick(); kill(); SFX.click(); }, {once:true});
  }
  function scheduleEvents(){
    // ğŸš€ å¹£ç‹ä¾†äº†ï¼ˆç©å®¶é›™å€ 10sï¼‰ â€” æ¯å±€ 1~2 æ¬¡
    timers.push(setTimeout(()=>{ if(!running) return; spawnEventBadge(pLane, 'ğŸš€ å¹£ç‹ä¾†äº† Ã—2 (10s)', ()=>{ doubleUntil = now()+10000; }, 3200); }, 5000+Math.random()*8000));
    timers.push(setTimeout(()=>{ if(!running) return; spawnEventBadge(pLane, 'ğŸš€ å¹£ç‹ä¾†äº† Ã—2 (10s)', ()=>{ doubleUntil = now()+10000; }, 3200); }, 15000+Math.random()*8000));

    // ğŸ¦¢ é»‘å¤©éµé–ƒå´©ï¼ˆå°æ‰‹è®Šæ…¢ 10sï¼‰ â€” æ¯å±€ 1~2 æ¬¡
    timers.push(setTimeout(()=>{ if(!running) return; spawnEventBadge(bLane, 'ğŸ¦¢ é»‘å¤©éµ(å°æ‰‹æ…¢ 10s)', ()=>{ swanUntil = now()+10000; }, 3000); }, 8000+Math.random()*9000));
    timers.push(setTimeout(()=>{ if(!running) return; spawnEventBadge(bLane, 'ğŸ¦¢ é»‘å¤©éµ(å°æ‰‹æ…¢ 10s)', ()=>{ swanUntil = now()+10000; }, 3000); }, 20000+Math.random()*8000));

    // æ§“æ¡¿ x2/x5/x10ï¼ˆéš¨æ©Ÿä¸€ç¨®ï¼Œç©å®¶ 10sï¼‰â€” æ¯å±€ä¸€æ¬¡
    timers.push(setTimeout(()=>{ if(!running||levSpawned) return; levSpawned=true; const opts=[2,5,10]; const m=opts[Math.floor(Math.random()*opts.length)]; spawnEventBadge(pLane, 'ğŸ’¥ æ§“æ¡¿ Ã—'+m+' (10s)', ()=>{ levMul=m; levUntil=now()+10000; }, 3600); }, 12000+Math.random()*12000));
  }

  function clearTimers(){ timers.forEach(t=>clearTimeout(t)); timers=[]; }

  function endRound(cause){
    running=false; clearTimeout(spawnTimerP); clearTimeout(spawnTimerB); clearTimeout(tickTimer); clearTimers();
    const elapsed = Math.max(16, Math.min(endAt, now()) - startAt); // ms
    const playedS = Math.round(elapsed/100)/10; // ç§’ï¼ˆä¸€ä½å°æ•¸ï¼‰

    const pA = apm(pClicks, elapsed), bA = apm(bClicks, elapsed);
    pApmEl.textContent=pA; bApmEl.textContent=bA;

    mP.textContent=pScore; mB.textContent=bScore; mPA.textContent=pA; mBA.textContent=bA;

    const margin = pScore - bScore;
    let verdict = '';
    if(cause==='surrender')      verdict = 'ä½ æŠ•é™äº†ï¼ˆä¸­é€”çµæŸï¼‰';
    else if(margin>0)            verdict = 'ä½ è´äº†ï¼ˆå¤šè»å¼·å‹¢ï¼‰';
    else if(margin<0)            verdict = 'ä½ è¼¸äº†ï¼ˆè¢«æ”¶å‰²ï¼‰';
    else                         verdict = 'å¹³æ‰‹';

    const oppSym = (TIER_SYMBOL[tierOf(current.opp)]||'');
    const detail = `å¹£ï¼š${current.coin}ï½œé›£åº¦ï¼š${labelOf(current.diff)}ï½œéˆï¼š${current.net}ï½œå°æ‰‹ï¼š${current.opp} ${oppSym}ï½œç”¨æ™‚ï¼šç´„ ${playedS}sï½œAPMï¼šä½  ${pA} / å°æ‰‹ ${bA}ï½œæ·¨åˆ†å·®ï¼š${Math.abs(margin)} U`;
    mR.innerHTML = `<div style="line-height:1.7"><div><b>${verdict}</b></div><div>${detail}</div></div>`;
    modal.style.display='grid';

    round++;
    const row={id:round, name:current.name, diff:labelOf(current.diff), chain:current.net, opp:current.opp+" "+oppSym, coin:current.coin, p:pScore, b:bScore, pApm:pA, bApm:bA, r:verdict};
    history.push(row); addRow(row);
  }

  function addRow(row){
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${row.id}</td><td>${row.name}</td><td>${row.diff}</td><td>${row.chain}</td><td>${row.opp}</td><td>${row.coin}</td><td>${row.p}</td><td>${row.b}</td><td>${row.pApm}</td><td>${row.bApm}</td><td>${row.r}</td>`;
    logTBody.prepend(tr);
  }

  function startGame(){
    current.name = (document.getElementById('playerName').value||'æœªå‘½å').slice(0,12);
    current.diff = document.getElementById('difficulty').value;
    current.opp  = document.getElementById('opponent').value;
    current.net  = document.getElementById('chain').value;
    current.coin = genCoin(); coinTag.textContent=current.coin;
    pNameEl.textContent=current.name; bNameEl.textContent=current.opp + ' ' + (TIER_SYMBOL[tierOf(current.opp)]||''); updateOppInfo(current.opp);

    // æ¸…å ´èˆ‡é‡ç½®
    pLane.querySelectorAll('.chive,.hazard,.event').forEach(n=>n.remove());
    bLane.querySelectorAll('.chive,.hazard,.event').forEach(n=>n.remove());
    resetScores(); SFX.resume(); clearTimers();

    // é‡ç½®äº‹ä»¶ç‹€æ…‹
    doubleUntil=0; swanUntil=0; levUntil=0; levMul=1; levSpawned=false;

    startAt=now(); endAt=startAt+60000; running=true; tick(); loopSpawn(); scheduleEvents();
    tip.textContent=`ç¬¬ ${round+1} å±€é–‹å§‹ï¼š${current.name}ï¼ˆ${labelOf(current.diff)}ï½œ${current.net}ï¼‰ å°æˆ° ${current.opp}ï¼›æœ¬å±€å¹£ï¼š${current.coin}`;
  }

  function stopAll(){ running=false; clearTimeout(spawnTimerP); clearTimeout(spawnTimerB); clearTimeout(tickTimer); clearTimers(); }

  // ========= äº‹ä»¶ =========
  startBtn.addEventListener('click', ()=>{ if(!running){ SFX.click(); showCountdown(()=>startGame()); }});
  stopBtn.addEventListener('click', ()=>{ stopAll(); SFX.click(); });
  document.getElementById('surrenderBtn').addEventListener('click', ()=>{ if(running){ endRound('surrender'); SFX.click(); } });
  muteBtn.addEventListener('click', ()=>{ const on=SFX.toggle(); muteBtn.textContent= on? 'ğŸ”Š è²éŸ³é–‹' : 'ğŸ”‡ è²éŸ³é—œ'; SFX.click();});

  // å°æ‰‹é¸æ“‡å™¨äº‹ä»¶
  $('#chooseOppBtn').addEventListener('click', ()=>{ SFX.click(); openOppModal(); });
  $('#oppClose').addEventListener('click', ()=>{ document.getElementById('oppModal').style.display='none'; SFX.click(); });
  Array.from(document.querySelectorAll('#oppModal [data-tier]')).forEach(b=>{
    tierButtons.push(b);
    b.addEventListener('click', ()=>{ setActiveTier(b); renderOppGrid(b.getAttribute('data-tier')); SFX.click(); });
  });
  $('#addOppBtn').addEventListener('click', ()=>{ SFX.click(); openOppModal(); document.getElementById('customOppName').focus(); });
  $('#customOppAdd').addEventListener('click', ()=>{
    const n=document.getElementById('customOppName').value.trim();
    const t=document.getElementById('customOppTier').value;
    if(!n) return;
    if(!OppMap.has(n)) { ROSTER.push({name:n,tier:t}); OppMap.set(n,t); }
    renderOppGrid(t);
    document.getElementById('customOppName').value='';
    updateOppInfo(n);
    document.getElementById('opponent').value=n; document.getElementById('chosenOpp').textContent=n; bNameEl.textContent=n + ' ' + (TIER_SYMBOL[tierOf(n)]||'');
    SFX.pop();
  });

  restart.addEventListener('click', ()=>{ modal.style.display='none'; showCountdown(()=>startGame()); });
  closeBtn.addEventListener('click', ()=>{ modal.style.display='none'; document.querySelector('.hero').scrollIntoView({behavior:'smooth'}); });

  // è¡Œå‹•è£ç½®ï¼šé¿å…é»æ“ŠéŸ­èœè§¸ç™¼æ»¾å‹•
  ;[pLane,bLane].forEach(l=> l.addEventListener('touchstart', e=>{ if(e.target.closest('.chive')||e.target.closest('.hazard')||e.target.closest('.event')) e.preventDefault(); }, {passive:false}));

  // ========= è‡ªå‹•æ¸¬è©¦ï¼ˆæ–·è¨€ï¼‰ =========
  (function tests(){
    try{
      console.group('%cè‡ªå‹•æ¸¬è©¦','color:#10b981;font-weight:700');
      console.assert(typeof showCountdown==='function','å€’æ•¸å­˜åœ¨');
      console.assert(typeof genCoin==='function' && genCoin().startsWith('$'),'å¹£åç”Ÿæˆ OK');
      console.assert(['inner','premarket','outer'].every(k=>DIFFS[k]), 'é›£åº¦ DIFFS éµé½Šå…¨');
      console.assert(['CZ','é¯¨é­š','DEV','åº„å®¶','å¤§è€'].every(k=>BOT_PROFILE[k]), 'å°æ‰‹ BOT_PROFILE éµé½Šå…¨');
      // æ–°å¢æ¸¬è©¦ï¼šåå–®èˆ‡åˆ†ç´š
      console.assert(ROSTER.some(o=>o.tier==='GOD'),'åå–®åŒ…å« GOD');
      console.assert(ROSTER.some(o=>o.tier==='N'),'åå–®åŒ…å« N');
      console.assert(NETS.SOL && NETS.BSC, 'NETS å…©æ¢éˆå­˜åœ¨');
      console.assert(typeof MOVE_CHANCE==='number' && MOVE_CHANCE>0, 'MOVE_CHANCE å­˜åœ¨');
      console.assert(hazardRate(0)>=0 && hazardRate(1)<=0.6, 'hazardRate åˆç†');
      console.assert(burstCount(0)>=1 && burstCount(1)>=1, 'burstCount è‡³å°‘ç‚º 1');
      console.assert((()=>{const _p=pScore; addScore('p',10); addScore('p',-10); return pScore===_p;})(), 'addScore Â±10 å¯é€†ï¼ˆå€ç‡=1ï¼‰');
      // æ–°å¢æ¸¬è©¦ï¼šå¹£ç‹Ã—2 èˆ‡æ§“æ¡¿Ã—2 ç–ŠåŠ æ‡‰ +40Uï¼›è² åˆ†åªåƒæ§“æ¡¿ -20U
      const save={pScore,bScore,doubleUntil,levUntil,levMul};
      pScore=0; doubleUntil=Date.now()+1000; levUntil=Date.now()+1000; levMul=2;
      addScore('p',10); console.assert(pScore===40,'æ­£åˆ†ï¼šå¹£ç‹Ã—2èˆ‡æ§“æ¡¿Ã—2 ç–ŠåŠ æ‡‰ç‚º +40U');
      addScore('p',-10); console.assert(pScore===20,'è² åˆ†ï¼šåªåƒæ§“æ¡¿Ã—2 æ‡‰ç‚º -20Uï¼Œåˆè¨ˆå‰© 20U');
      ({pScore,bScore,doubleUntil,levUntil,levMul} = save);
      console.groupEnd();
    }catch(e){ console.error('Tests error:', e); }
  })();

  // å°æ‰‹è³‡æ–™ï¼ˆè³‡ç”¢ã€é›£åº¦ã€ç°¡ä»‹ï¼‰
  const OPP_INFO={
    'ä¸­æœ¬è°':{tier:'GOD',money:'700å„„',lvl:'ç¥',desc:'æ¯”ç‰¹å¹£å‰µä¸–è€…ï¼Œå€å¡Šéˆä¿¡ä»°æºé ­'},
    'è¶™é•·éµ¬CZ':{tier:'UR',money:'150å„„',lvl:'ç¥',desc:'å¹£å®‰å‰µè¾¦äººï¼Œå…¨çƒæœ€å¤§äº¤æ˜“ç‰ˆåœ–'},
    'å­«å®‡æ™¨':{tier:'UR',money:'25å„„',lvl:'é¾',desc:'æ³¢å ´å‰µè¾¦äººï¼Œè©±é¡Œèˆ‡è³‡æœ¬é›™å…¨'},
    'è–›è »å­':{tier:'UR',money:'15å„„',lvl:'é¾',desc:'ä¸­åœ‹æ—©æœŸå¤©ä½¿æŠ•è³‡è€…ï¼Œæ”¿å•†è³‡æºæ·±åš'},
    'å³å¿Œå¯’':{tier:'UR',money:'20å„„',lvl:'é¾',desc:'æ¯”ç‰¹å¤§é™¸å‰µè¾¦äººï¼Œç¤¦æ¥­éœ¸ä¸»'},
    'å¾æ˜æ˜Ÿ':{tier:'UR',money:'20å„„',lvl:'é¾',desc:'OKå‰µè¾¦äººï¼Œäº¤æ˜“æ‰€é‡é‡ç´š'},
    'æœå‡':{tier:'UR',money:'12å„„',lvl:'é¾',desc:'ç«å¹£å‰µè¾¦äººä¹‹ä¸€ï¼ŒæŠ•è³‡å¸ƒå±€æ·±'},
    'ä½•ä¸€':{tier:'UR',money:'10å„„',lvl:'é¾',desc:'å¹£å®‰è¯åˆå‰µè¾¦äººï¼Œè¡ŒéŠ·èˆ‡ç¤¾ç¾¤ICON'},
    'ææ—':{tier:'UR',money:'10å„„',lvl:'é¾',desc:'ç«å¹£å‰µè¾¦äººï¼Œè¯èªäº¤æ˜“æ‰€å…ƒè€'},
    'Vç¥':{tier:'UR',money:'6å„„',lvl:'é¾',desc:'ä»¥å¤ªåŠå‰µè¾¦äººï¼Œæ™ºèƒ½åˆç´„é©å‘½è€…'},
    'Roger Ver':{tier:'UR',money:'6å„„',lvl:'é¾',desc:'ã€Œæ¯”ç‰¹å¹£è€¶ç©Œã€ï¼Œæ—©æœŸæ——æ‰‹èˆ‡åˆ†å‰è«–æˆ°ä¸­å¿ƒ'},
    'Yi He':{tier:'UR',money:'8880è¬',lvl:'é¬¼',desc:'å¹£å®‰éˆé­‚äººç‰©ï¼Œå“ç‰Œèˆ‡å¸‚å ´å¼·åŠ›æ¨æ‰‹'},
    'HongKongDoll':{tier:'UR',money:'6660è¬',lvl:'é¬¼',desc:'æ¸¯åœˆç†±é–€KOLï¼Œç¤¾ç¾¤ç©¿é€é«˜'},

    'æå•“å¨':{tier:'SSR',money:'5å„„',lvl:'é¾',desc:'èŠç‰¹å¹£å‰µè¾¦äººï¼Œæ—©æœŸæŠ€è¡“æ´¾'},
    'BM':{tier:'SSR',money:'4å„„',lvl:'é¾',desc:'EOSå‰µè¾¦äººï¼Œæ›¾é ˜æ½®Web3åŸºç¤éˆ'},
    'æ²ˆæ³¢':{tier:'SSR',money:'3å„„',lvl:'é¬¼',desc:'åˆ†å¸ƒå¼è³‡æœ¬åˆå¤¥äººï¼ŒæŠ•è³‡è€å…µ'},
    'è¶™æ±':{tier:'SSR',money:'3å„„',lvl:'é¬¼',desc:'DFundå‰µè¾¦äººï¼Œè¯èªèŠå®¶ä»£è¡¨'},
    'å‘¨ç¢©åŸº':{tier:'SSR',money:'2å„„',lvl:'é¬¼',desc:'FBGå‰µè¾¦äººï¼Œé‡åŒ–èˆ‡æŠ•è³‡ä½ˆå±€'},
    'æç¬‘ä¾†':{tier:'SSR',money:'2å„„',lvl:'é¬¼',desc:'è‡ªç¨±ä¸­åœ‹æ¯”ç‰¹å¹£é¦–å¯Œï¼Œæ•™è‚²èˆ‡æŠ•è³‡åœˆåäºº'},
    'é”é´»é£›':{tier:'SSR',money:'2å„„',lvl:'é¬¼',desc:'NEOå‰µè¾¦äººï¼Œä¸­åœ‹å…¬éˆä»£è¡¨'},
    'ä½•æ–Œ':{tier:'SSR',money:'1å„„',lvl:'é¬¼',desc:'imTokenå‰µè¾¦äººï¼ŒéŒ¢åŒ…é ˜åŸŸå…ˆè¡Œè€…'},
    'é•·é‹':{tier:'SSR',money:'1å„„',lvl:'é¬¼',desc:'å·´æ¯”ç‰¹å‰µè¾¦äººï¼Œä¸­åœ‹éˆåœˆä¿¡æ¯æº'},
    'å¸¥åˆ':{tier:'SSR',money:'1å„„',lvl:'é¬¼',desc:'é‡å­éˆå‰µè¾¦äººï¼Œåœ‹ç”¢å…¬éˆå…ˆé‹’'},
    'éŸ“å³¯':{tier:'SSR',money:'1å„„',lvl:'é¬¼',desc:'äº¦ä¾†é›²å‰µè¾¦äººï¼Œå»ä¸­å¿ƒåŒ–èº«ä»½æ¢ç´¢'},
    'æ±Ÿå“çˆ¾':{tier:'SSR',money:'1å„„',lvl:'é¬¼',desc:'ç¤¦æ± å¤§ä½¬ï¼ŒæŠ€è¡“è«–æˆ°æ´»èº'},
    'å‘‚æ—­è»':{tier:'SSR',money:'1å„„',lvl:'é¬¼',desc:'è¬ç¶­éˆå‰µè¾¦äººï¼Œå¤šéˆè·¨éˆæ¢ç´¢'},
    'ç‹å¯¶è²¡':{tier:'SSR',money:'8000è¬',lvl:'è™',desc:'å…¬ä¿¡éˆå‰µè¾¦äººï¼ŒæŠ€è¡“å¸ƒé“'},
    'å¯¶äºŒçˆº':{tier:'SSR',money:'7000è¬',lvl:'è™',desc:'å¹£åœˆåå˜´ï¼Œè‡ªå¸¶è©±é¡Œ'},
    'Dujun(KOL)':{tier:'SSR',money:'3600è¬',lvl:'è™',desc:'ç«å¹£è¯å‰µï¼ŒæŠ•è³‡è¦–é‡å»£'},
    'WolfyXBT':{tier:'SSR',money:'1888è¬',lvl:'è™',desc:'æ•¸æ“šæµäº¤æ˜“KOL'},
    'Star(OKX)':{tier:'SSR',money:'2220è¬',lvl:'è™',desc:'OKXç®¡ç†å±¤ï¼Œäº¤æ˜“ç”¢å“æ¨å‹•åŠ›é‡'},
    'Phyrex':{tier:'SSR',money:'999è¬',lvl:'è™',desc:'4XLabså‰µå§‹äººï¼Œå¸‚å ´è¼”å°è€…'},
    '0xWizard':{tier:'SSR',money:'942è¬',lvl:'è™',desc:'DeFi/Memecoinæ´»èºäººå£«'},
    'ä½™å¼¦':{tier:'SSR',money:'888è¬',lvl:'è™',desc:'å®‰å…¨å°ˆå®¶ï¼ŒSlowMistå‰µè¾¦äºº'},
    'èŠ±èŠ±':{tier:'SSR',money:'880è¬',lvl:'è™',desc:'KOLèˆ‡äº¤æ˜“ç­–ç•¥åˆ†äº«è€…'},
    'å¤§å®‡':{tier:'SSR',money:'775è¬',lvl:'è™',desc:'è¯èªç¤¾ç¾¤å·¥å…·æµä»£è¡¨'},
    'ç†¬é·¹è³‡æœ¬':{tier:'SSR',money:'775è¬',lvl:'è™',desc:'æŠ•ç ”èˆ‡æµé‡æ··åˆè§’è‰²'},
    'å·æ²':{tier:'SSR',money:'770è¬',lvl:'è™',desc:'Solanaæ´¾äº¤æ˜“è€…'},
    'Aiå§¨':{tier:'SSR',money:'690è¬',lvl:'è™',desc:'åŠ å¯†ç„å­¸å…§å®¹å‰µä½œè€…'},
    'Gokuå¾ˆCool':{tier:'SSR',money:'660è¬',lvl:'è™',desc:'åŠ å¯†ç¤¾ç¾¤èˆ‡é …ç›®å”ä½œè€…'},
    'Jason':{tier:'SSR',money:'625è¬',lvl:'è™',desc:'æŠ•ç ”åˆ†æKOL'},
    'Moonlight':{tier:'SSR',money:'610è¬',lvl:'è™',desc:'KOLèˆ‡ç¤¾ç¾¤é‹ç‡Ÿè€…'},
    'ä½™çƒ¬':{tier:'SSR',money:'720è¬',lvl:'è™',desc:'éˆä¸Šæ•¸æ“šæ¬é‹èˆ‡åˆ†æ'},
    'Ninerä¹å…’':{tier:'SSR',money:'550è¬',lvl:'è™',desc:'åŠ å¯†å‚ç›´å…§å®¹å‰µä½œè€…'},
    'ç«æ˜Ÿäºº':{tier:'SSR',money:'3000è¬',lvl:'è™',desc:'åˆä»£å¹£åœˆç´…äºº'},
    'è¶™åœ‹å³¯':{tier:'SSR',money:'3000è¬',lvl:'è™',desc:'æ—©æœŸå¸ƒå±€æŠ•è³‡äºº'},
    'ç”³å± é’æ˜¥':{tier:'SSR',money:'3000è¬',lvl:'è™',desc:'éŠ€éˆç§‘æŠ€å‰µè¾¦äºº'},
    'æ½˜åœ‹åŠ›':{tier:'SSR',money:'2000è¬',lvl:'è™',desc:'å¹£è¶¨å‹¢å‰µè¾¦è€…'},
    'é»ƒé€£é‡‘':{tier:'SSR',money:'2000è¬',lvl:'è™',desc:'è¯ç‚ºå€å¡Šéˆå°ˆå®¶'},
    'åˆå¤è™':{tier:'SSR',money:'2000è¬',lvl:'è™',desc:'å…ƒç•Œå‰µè¾¦äºº'},
    'æœ±å˜‰å‰':{tier:'SSR',money:'2000è¬',lvl:'è™',desc:'ç«å¹£COO'},
    'è«‡åœ‹éµ¬':{tier:'SSR',money:'2000è¬',lvl:'è™',desc:'å·´æ¯”ç‰¹å°ˆæ¬„ä½œå®¶'},
    'å·¨èŸ¹':{tier:'SSR',money:'2000è¬',lvl:'è™',desc:'BTSç†äº‹ï¼Œå…§å®¹è£½ä½œè€…'},
    'é«˜åŸé£›ç‡•':{tier:'SSR',money:'1000è¬',lvl:'è™',desc:'ç¤¾ç¾¤å‹å‰µæ¥­è€…'},
    'è—ç·£å¯¶YYBCåˆå¤¥äºº â€”':{tier:'SSR',money:'æœªå…¬é–‹',lvl:'ç¥',desc:'è·¨è—è¡“è³‡ç”¢éˆæ”¹æ¦‚å¿µæ“ç›¤'},

    'Benmo.eth':{tier:'SR',money:'420è¬',lvl:'é¬¼',desc:'DeFiå¥—åˆ©ç¤¾ç¾¤é‹ç‡Ÿ'},
    'AB Kuai':{tier:'SR',money:'466è¬',lvl:'é¬¼',desc:'KOLèˆ‡ç”Ÿæ…‹åƒèˆ‡è€…'},
    'å­æ™‚':{tier:'SR',money:'320è¬',lvl:'é¬¼',desc:'å¤šéˆå·¥å…·æ¨å»£è€…'},
    'æ½›æ°´è§€å¯Ÿå“¡':{tier:'SR',money:'125è¬',lvl:'è™',desc:'ä¿¡æ¯è§€å¯Ÿå¸³è™Ÿ'},
    'å†·éœå†·éœ':{tier:'SR',money:'260è¬',lvl:'è™',desc:'é¢¨éšªæç¤ºèˆ‡æƒ…ç·’æ´¾'},
    'Rui':{tier:'SR',money:'298è¬',lvl:'è™',desc:'HashKeyè³‡æœ¬è§’è‰²'},
    'Sea':{tier:'SR',money:'188è¬',lvl:'è™',desc:'å…§å®¹ï¼‹äº¤æ˜“æ··åˆKOL'},
    'Bruce':{tier:'SR',money:'740è¬',lvl:'è™',desc:'ç¤¦å ´ç›¸é—œèƒŒæ™¯'},
    'Rocky':{tier:'SR',money:'1288è¬',lvl:'è™',desc:'é•·æœŸéˆä¸Šå‰¯æ¥­æŠ•è³‡è€…'},

    'Ru7':{tier:'R',money:'240è¬',lvl:'è™',desc:'å¤šéˆè©±é¡Œå‹KOL'},
    'Cindyèƒ–è¿ª':{tier:'R',money:'298è¬',lvl:'è™',desc:'åŠ å¯†å¥³æ€§KOL'},
    'KingPan':{tier:'R',money:'150è¬',lvl:'è™',desc:'ç¤¾ç¾¤å‹æŠ•è³‡è€…'},

    'XinGPT':{tier:'N',money:'133è¬',lvl:'ç‹¼',desc:'AIï¼‹åŠ å¯†å…§å®¹å‰µä½œæ–°é¢å­”'},
    'BlueFox':{tier:'N',money:'268è¬',lvl:'ç‹¼',desc:'Web3ç­†è¨˜å‹å¸³è™Ÿ'},
    'Dotç‹å­':{tier:'N',money:'190è¬',lvl:'ç‹¼',desc:'DOTç”Ÿæ…‹æ„›å¥½è€…'},
    'MoonApe':{tier:'N',money:'155è¬',lvl:'ç‹¼',desc:'NFTç©å®¶'},
    'CryptoMaid':{tier:'N',money:'495è¬',lvl:'ç‹¼',desc:'å¨›æ¨‚è©±é¡Œå‰µä½œè€…'},
    'JamesX':{tier:'N',money:'52è¬',lvl:'ç‹¼',desc:'Web3é¡§å•è‡ªä»‹å¸³è™Ÿ'},
    'å°åˆ€':{tier:'N',money:'190è¬',lvl:'ç‹¼',desc:'åˆç´„èˆ‡æƒ…ç·’æµKOL'},
    'ZeroValue':{tier:'N',money:'88è¬',lvl:'ç‹¼',desc:'æ–°èˆˆåŠ å¯†è©•è«–å¸³'}
  };

  function updateOppInfo(name){
    const box=document.getElementById('oppInfoBody');
    const info=OPP_INFO[name];
    const tier=tierOf(name); const sym=TIER_SYMBOL[tier]||'';
    if(!info){ box.innerHTML=`${sym} <b>${name}</b>ï¼ˆ${tier}ï¼‰<br><span class="tag">æš«ç„¡è³‡æ–™</span>`; return; }
    box.innerHTML=`<div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap">
      <span class="score">${sym} ${name}</span>
      <span class="tag">è³‡ç”¢ï¼š${info.money}</span>
      <span class="tag">é›£åº¦ï¼š${info.lvl}</span>
    </div>
    <div style="margin-top:6px">${info.desc}</div>`;
  }

  </script>
</body>
</html>
